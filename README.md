# mfanalyzer

A tool for quick and dirty analysis of suspicious files. Designed to run inside Remnux!

# A few important points:

- This script should be run in a safe sandbox envronment! Remnux is preferrable (https://remnux.org/.)
- Written in Python 2.7. I know, its old and outdated, but it still works ;)
- This script has some bugs and has no error handling. As mentioned, it is "quick and dirty".

# Example usage and output:

Get a list of all parameters:

> python2.7 mfanalyzer.py

Execute the script on a PE executable file:

remnux@remnux python2.7 mfanalyzer.py --bin -s -y -x -o malware.exe 
[*] Created output directory: ./mfanalyzer-1683123828/.
[*] Attempting to deobfuscate strings (FLOSS)...
[*] Searching for shellcode and XORed data (XORsearch)...
[*] Attempting to extract malware config (malconf) ...
[*] Extracting strings...
[*] Ranking strings using FLARE StringSifter...
[*] Extracting interesting strings (using provided strings file)...
[*] Extracting encoded strings...
[*] Extracting base64 strings (base64dump)...
[*] Searching for shellcode and XORed data (XORsearch)...
[*] Running Yara ruleset...
[*] Brute-forcing possible XORed strings (brxor)...
[*] Searching for XORed strings from stringslist (XORsearch)...

[+] Done! All results and dumped files are located in ./mfanalyzer-1683123828/.
[+] Preparing to open in text editor...

Execute the script on a Office Document file:

remnux@remnux: python2.7 mfanalyzer.py --doc -s -y -x -o malware.pptx 
[*] Created output directory: ./mfanalyzer-1683124037/.
[*] Extracting metadata (exiftool)...
[*] Extracting OLE information (oleid)...
[*] Extracting VBA code (olevba)...
[*] Extracting VBA strings (oledump)
[*] Extracting P-code (pcodedmp)...
[*] Extracting strings...
[*] Ranking strings using FLARE StringSifter...
[*] Extracting interesting strings (using provided strings file)...
[*] Extracting encoded strings...
[*] Extracting base64 strings (base64dump)...
[*] Searching for shellcode and XORed data (XORsearch)...
[*] Running Yara ruleset...
[*] Brute-forcing possible XORed strings (brxor)...
[*] Searching for XORed strings from stringslist (XORsearch)...

[+] Done! All results and dumped files are located in ./mfanalyzer-1683124037/.
[+] Preparing to open in text editor...
